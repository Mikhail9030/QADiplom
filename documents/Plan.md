## План автоматизации тестирования сервиса покупки туров через интернет-банк
## 1. Перечень автоматизируемых сценариев
### UI Тесты
### Сценарии Happy Path:
Happy Path 1: Покупка тура через кнопку "Купить" с главной страницы сервиса.
### Cценарий 1.1: Оплата с помощью валидной карты, на которой есть достаточное количество денежных средств. Операция должна быть одобрена.
#### Шаги по воспроизведению:
1. На главной странице сервиса нажимаем на кнопку  "Купить";
2. Заполняем форму заявки полностью валидными данными карты, на которой достаточно ДС: "Номер" = "4444 4444 4444 4441", "Месяц" = "10", "Год" = "22", "Владелец" = "Ivanov Petr", "CVV" = "111";
3. Нажимаем на кнопку "Продолжить";
4. Ожидаем результат после отправки запроса в банк.
#### Ожидаемый результат: появляется уведомление "Успешно. Операция одобрена Банком".
### Cценарий 1.2: Оплата с валидной карты, на которой недостаточное количество денежных средств. Отказ в проведении операции.
#### Шаги по воспроизведению:
1. На главной странице сервиса нажимаем на кнопку "Купить";
2. Заполняем форму заявки полностью валидными данными карты, на которой недостаточно ДС: "Номер" = "4444 4444 4444 4442", "Месяц" = "10", "Год" = "22", "Владелец" = "Ivanov Petr", "CVV" = "111";
3. Нажимаем на кнопку "Продолжить";
4. Ожидаем результат после отправки запроса в банк.
#### Ожидаемый результат: появляется уведомление об ошибке "Ошибка! Банк отказал в проведении операции".

Happy Path 2: Покупка тура через кнопку "Купить в кредит" с главной страницы сервиса.
### Cценарий 2.1: Оплата в кредит с помощью валидной карты, с достаточным кредитным лимитом. Операция должна быть одобрена.
#### Шаги по воспроизведению:
1. На главной странице сервиса нажимаем на кнопку "Купить";
2. Заполняем форму заявки полностью валидными данными карты, на которой не исчерпан кредитный лимит: "Номер" = "4444 4444 4444 4441", "Месяц" = "10", "Год" = "22", "Владелец" = "Ivanov Petr", "CVV" = "111";
3. Нажимаем на кнопку "Продолжить";
4. Ожидаем результат после отправки запроса в банк.
#### Ожидаемый результат: появляется уведомление "Успешно. Операция одобрена Банком".
### Cценарий 2.2: Оплата в кредит с помощью валидной карты, с недостаточным кредитным лимитом. Отказ в проведении операции.
#### Шаги по воспроизведению:
1. На главной странице сервиса нажимаем на кнопку "Купить";
2. Заполняем форму заявки полностью валидными данными карты, на которой исчерпан кредитный лимит: "Номер" = "4444 4444 4444 4442", "Месяц" = "10", "Год" = "22", "Владелец" = "Ivanov Petr", "CVV" = "111";
3. Нажимаем на кнопку "Продолжить";
4. Ожидаем результат после отправки запроса в банк.
#### Ожидаемый результат: появляется уведомление об ошибке "Ошибка! Банк отказал в проведении операции".

### Тестируем поля форм ввода данных
#### Нужно войти на страницу формы.
* Для формы "Оплата по карте": на главной странице сервиса нажимаем на кнопку "Купить";
* Для формы "Кредит по данным карты": на главной странице сервиса нажимаем на кнопку "Купить в кредит";
#### После заполнения полей кликаем на кнопку "Продолжить" и ожидаем результат. 
### Поля "Номер карты"
#### Предусловия для формы "Купить":
1. На главной странице сервиса нажимаем на кнопку "Купить";
2. Заполняем поля следующими валидными данными: "Месяц" = "10", "Год" = "22", "Владелец" = "Ivanov Petr", "CVV" = "111".
#### Предусловия для формы "Купить в кредит":
1. На главной странице сервиса нажимаем на кнопку "Купить в кредит";
2. Заполняем поля следующими валидными данными: "Месяц" = "10", "Год" = "22", "Владелец" = "Ivanov Petr", "CVV" = "111".
#### Негативные сценарии:
* При вводе некорректных данных под полем ввода "Номер карты" должно появляться сообщение об ошибке ("Поле обязательно для заполнения", "Неверный формат" или "Ошибка! Банк отказал в проведении операции.", в зависимости от кейса).

1. Заявка не должна отправляться, если поле "Номер карты" пустое;
2. Заявка не должна отправляться, если поле "Номер карты" содержит 15 цифр (например, "4444 4444 4444 444");
3. Заявка не должна отправляться, если поле "Номер карты" содержит номер карты другого банка, которого нет в БД (например, "5559 4444 4444 4444").
### Поле "Месяц"
#### Предусловия для формы "Купить":
1. На главной странице сервиса нажимаем на кнопку "Купить";
2. Заполняем поля следующими валидными данными: "Номер" = "4444 4444 4444 4441", "Год" = "22", "Владелец" = "Ivanov Petr", "CVV" = "111".
#### Предусловия для формы "Купить в кредит":
1. На главной странице сервиса нажимаем на кнопку "Купить в кредит";
2. Заполняем поля следующими валидными данными: "Номер" = "4444 4444 4444 4441", "Год" = "22", "Владелец" = "Ivanov Petr", "CVV" = "111".
#### Негативные сценарии:
1. Заявка не должна отправляться, если поле "Месяц" пустое;
2. Заявка не должна отправляться, если поле "Месяц" содержит нерелевантное значение (например, "00");
3. Заявка не должна отправляться, если поле "Месяц" содержит любое двузначное число, которое больше 12 (например, "13");
4. Заявка не должна отправляться, если поле "Месяц" содержит одну цифру (например, "1").
### Поле "Год"
#### Предусловия для формы "Купить":
1. На главной странице сервиса нажимаем на кнопку "Купить";
2. Заполняем поля следующими валидными данными: "Номер" = "4444 4444 4444 4441", "Месяц" = "10", "Владелец" = "Ivanov Petr", "CVV" = "111".
#### Предусловия для формы "Купить в кредит":
1. На главной странице сервиса нажимаем на кнопку "Купить в кредит";
2. Заполняем поля следующими валидными данными: "Номер" = "4444 4444 4444 4441", "Месяц" = "10", "Владелец" = "Ivanov Petr", "CVV" = "111".
#### Негативные сценарии:
* При вводе некорректных данных под полем ввода "Год" должно появляться сообщение об ошибке ("Поле обязательно для заполнения", "Неверно указан срок действия карты" или "Истёк срок действия карты" в зависимости от кейса).
1. Заявка не должна отправляться, если поле "Год" пустое;
2. Заявка не должна отправляться, если поле "Год" содержит цифры ранее текущего года (например, "19");
3. Заявка не должна отправляться, если поле "Год" содержит цифры намного позже текущего года (например, "50").
### Поле "Владелец"
* Требования: данное поле принимает на вход только фамилию и имя на латинском, первая буква в каждом из слов автоматически делается заглавной.
#### Предусловия для формы "Купить":
1. На главной странице сервиса нажимаем на кнопку "Купить";
2. Заполняем поля следующими валидными данными: "Номер" = "4444 4444 4444 4441", "Год" = "22", "Месяц" = "10", "CVV" = "111".
#### Предусловия для формы "Купить в кредит":
1. На главной странице сервиса нажимаем на кнопку "Купить в кредит";
2. Заполняем поля следующими валидными данными: "Номер" = "4444 4444 4444 4441", "Год" = "22", "Месяц" = "10", "CVV" = "111".
#### Негативные сценарии:
1. Заявка не должна отправляться, если поле "Владелец" пустое;
2. Заявка не должна отправляться, если поле "Владелец" содержит одно слово на латинице (например, "Ivanov");
3. Заявка не должна отправляться, если поле "Владелец" содержит три слова на латинице (например, "Ivanov Petr Ivanovich");
4. Заявка не должна отправляться, если поле "Владелец" содержит фамилию и имя в нижнем регистре (например, "ivanov petr");
5. Заявка не должна отправляться, если поле "Владелец" содержит фамилию и имя в верхнем регистре (например, "IVANOV PETR");
6. Заявка не должна отправляться, если поле "Владелец" содержит фамилию и имя на кириллице (например, "Иванов Петр");
7. Заявка не должна отправляться, если поле "Владелец" содержит цифры (например, "12345");
8. Заявка не должна отправляться, если поле "Владелец" содержит нерелевантные символы (например, "%№%№").

### Поле "CVV"
* ребования: данное поле принимает на вход только 3 цифры.
#### Предусловия для формы "Купить":
1. На главной странице сервиса нажимаем на кнопку "Купить";
2. Заполняем поля следующими валидными данными: "Номер" = "4444 4444 4444 4441", "Год" = "22", "Месяц" = "10", "Владелец" = "Ivanov Petr".
#### Предусловия для формы "Купить в кредит":
1. На главной странице сервиса нажимаем на кнопку "Купить в кредит";
2. Заполняем поля следующими валидными данными: "Номер" = "4444 4444 4444 4441", "Год" = "22", "Месяц" = "10", "Владелец" = "Ivanov Petr".
#### Негативные сценарии:
* При вводе некорректных данных под полем ввода "CVV" должно появляться сообщение об ошибке ("Поле обязательно для заполнения" или "Неверный формат").
1. Заявка не должна отправляться, если поле "CVV" пустое;
2. Заявка не должна отправляться, если поле "CVV" содержит одну цифру (например, "1");
3. Заявка не должна отправляться, если поле "CVV" содержит две цифры (например, "11").

### API-тесты
* Необходимо убедиться, что при попытке обратиться к приложению через API сервис отдает те же данные, что и при UI-тестах. Для этого будут необходимы 4 теста, которые проверяют разные карты и статус этих карт в БД.
#### Предусловия для валидной карты со статусом APPROVED:
"Номер" = "4444 4444 4444 4441", "Месяц" = "10", "Год" = "22", "Владелец" = "Ivanov Petr", "CVV" = "111".
#### Предусловия для валидной карты со статусом DECLINED:
"Номер" = "4444 4444 4444 4442", "Месяц" = "10", "Год" = "22", "Владелец" = "Ivanov Petr", "CVV" = "111".
#### Тест-кейсы:
1. Удостоверяемся, что при обращении к URL-адресу http://localhost:8080/api/v1/pay мы получаем код ответа сервера 200 и банковская карта c номером "4444 4444 4444 4441" отдает статус APPROVED.
2. Удостоверяемся, что при обращении к URL-адресу http://localhost:8080/api/v1/pay мы получаем код ответа сервера 200 и банковская карта с номером "4444 4444 4444 4442" отдает статус DECLINED.
3. Удостоверяемся, что при обращении к URL-адресу http://localhost:8080/api/v1/credit мы получаем код ответа сервера 200 и банковская карта c номером "4444 4444 4444 4441" отдает статус APPROVED.
4. Удостоверяемся, что при обращении к URL-адресу http://localhost:8080/api/v1/credit мы получаем код ответа сервера 200 и банковская карта с номером "4444 4444 4444 4442" отдает статус DECLINED.

## 2. Перечень используемых инструментов
* IntelliJ IDEA Community Edition
* Java 11.0.10
* Git
* Gradle
* JUnit5
* Selenide
* Lombok
* JavaFaker
* Docker
* Allure
* VisualStudioCode

## 3. Перечень возможных рисков при автоматизации:
* Технические сложности с настройкой Docker-compose.yml и SUT — возможные проблемы с "поднятием" БД, SUT не запускается и т.п.;
* Сложности к раздельным подключением тестов через БД MySQL и PostgreSQL;
* Ложные срабатывания тестов из-за некорректно сгенерированных данных Faker'ом;
* Если в будущем будет переделан дизайн, фирменный стиль сайта (либо просто изменены какие-то данные), то тесты могут не проходить. К примеру, можно изначально привязаться с exactText к одному тексту, а если его изменят на другой, то тесты уже не будут проходить;
* Сложности с поиском и привязкой к необходимым CSS-селекторам для Selenide.

## 4. Интервальная оценка с учётом рисков (в часах)
* Подготовка к проведению тестирования — 10 часов;
* Написание кода + рефакторинг — 50 часов;
* Резерв времени на написание баг-репортов — 10 часов;
* Подготовка отчета о результатах прогона тестов — 10 часов;
* Подготовка комплексного отчета по всему процессу автоматизации тестирования — 18 часов;

## 5. План сдачи работ
* Готовность авто-тестов — через 6 календарных дней после согласования плана;
* Подготовка отчетов по итогам прогона тестов — через 2 календарных дня после прогона тестов;
* Подготовка комплексного отчета по итогам автоматизации — через 2 календарных дня после отчетов по прогону и написания баг-репортов.